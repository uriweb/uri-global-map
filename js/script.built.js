var transformRequest=(e,t)=>({url:"api.mapbox.com"===e.slice(8,22)||"tiles.mapbox.com"===e.slice(10,26)?e.replace("?","?pluginName=sheetMapper&"):e});mapboxgl.accessToken="pk.eyJ1IjoiYWdhdXNzIiwiYSI6ImNsY2h5dW9jMjAxM3czcnA4NjhhN3VteGQifQ.tm85m6IfIw5xsHEB0wqmgQ";var map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/satellite-v9",center:[30,20],zoom:2,maxZoom:3,minZoom:2,transformRequest:transformRequest,projection:"globe"});map.addControl(new mapboxgl.FullscreenControl),map.on("style.load",(()=>{map.setFog({})}));const secondsPerRevolution=120,maxSpinZoom=5,slowSpinZoom=3;let userInteracting=!1,spinEnabled=!0;function spinGlobe(){const e=map.getZoom();if(spinEnabled&&!userInteracting&&e<maxSpinZoom){let t=360/secondsPerRevolution;if(e>slowSpinZoom){t*=(maxSpinZoom-e)/(maxSpinZoom-slowSpinZoom)}const o=map.getCenter();o.lng-=t,map.easeTo({center:o,duration:1e3,easing:e=>e})}}map.on("mousedown",(()=>{userInteracting=!0})),map.on("mouseup",(()=>{userInteracting=!1,spinGlobe()})),map.on("dragend",(()=>{userInteracting=!1,spinGlobe()})),map.on("pitchend",(()=>{userInteracting=!1,spinGlobe()})),map.on("rotateend",(()=>{userInteracting=!1,spinGlobe()})),map.on("moveend",(()=>{spinGlobe()})),document.getElementById("btn-spin").addEventListener("click",(e=>{spinEnabled=!spinEnabled,spinEnabled?(spinGlobe(),e.target.innerHTML="Pause rotation"):(map.stop(),e.target.innerHTML="Start rotation")})),spinGlobe();const viewList=document.getElementById("menu"),inputs=viewList.getElementsByTagName("input");for(const e of inputs)e.onclick=e=>{const t=e.target.value;console.log(t),map.setProjection(t)};$(document).ready((function(){$.ajax({type:"GET",url:"https://docs.google.com/spreadsheets/d/1wIqM7Yfbpjt_jRiiasNB9uLdFiVAFG-7aw90DmH-odY/gviz/tq?tqx=out:csv&sheet=Sheet1",dataType:"text",success:function(e){!function(e){csv2geojson.csv2geojson(e,{latfield:"Latitude",lonfield:"Longitude",delimiter:","},(function(e,t){map.on("load",(function(){map.addLayer({id:"csvData",type:"circle",source:{type:"geojson",data:t},paint:{"circle-radius":12,"circle-color":"#c0ddf2"}}),map.on("click","csvData",(function(e){for(var t=e.features[0].geometry.coordinates.slice(),o="<h3>"+e.features[0].properties.Main_Header+'</h3><div class="flex-containter"><div class="boxlist"><ul><li><b>Location: </b>'+e.features[0].properties.Location+"</li><li><b>"+e.features[0].properties.Category2+"</b> "+e.features[0].properties.ListItem2+'</li><li><b><a href="'+e.features[0].properties.Link+'">'+e.features[0].properties.Link_Text+'</a></li></b></ul></div><div class="thumbnailpic"><img src="'+e.features[0].properties.Image+'" alt="'+e.features[0].properties.AltText+'"></div></div><p>'+e.features[0].properties.Description+"</p>";Math.abs(e.lngLat.lng-t[0])>180;)t[0]+=e.lngLat.lng>t[0]?360:-360;(new mapboxgl.Popup).setLngLat(t).setHTML(o).addTo(map)})),map.on("mouseenter","csvData",(function(){map.getCanvas().style.cursor="pointer"})),map.on("mouseleave","places",(function(){map.getCanvas().style.cursor=""}));var e=turf.bbox(t);map.fitBounds(e,{padding:50})}))}))}(e)}})}));